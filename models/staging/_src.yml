sources:
  - name: raw_data
    description: sorgenti dati iniziali caricate (csv)
    database: sportset
    schema: raw
    tables:

      - name: customers_raw
        description: tabella delle dimensioni customer.
        columns:
          - name: customer_key
            description: chiave primaria per i clienti.
            tests:
              - unique
              - not_null

      - name: dates_raw
        description: tabella delle dimensioni date.
        columns:
          - name: date_key
            description: chiave primaria del tempo.
            tests:
              - unique
              - not_null

      - name: products_raw
        description: tabella delle dimensioni product.
        columns:
          - name: product_key
            description: chiave primaria per i prodotti.
            tests:
              - unique
              - not_null

      - name: reseller_raw
        description: tabella delle dimensioni reseller.
        columns:
          - name: reseller_key
            description: chiave primaria per i rivenditori.
            tests:
              - unique
              - not_null

      - name: sales_territory_raw
        description: tabella delle dimensioni sales territory.
        columns:
          - name: sales_territory_key
            description: chiave primaria per i territori di vendita.
            tests:
              - unique
              - not_null


      - name: orders_raw
        description: tabella dei fatti delle vendite (dettaglio riga d'ordine).
        columns:
          - name: sales_order_line_key
            description: chiave primaria della riga d'ordine.
            tests:
              - unique
              - not_null

          - name: customer_key
            description: Chiave esterna per la dimensione customer.
            tests:
              - relationships:
                  to: source('raw_data', 'customers_raw')
                  field: customer_key
          
          - name: product_key
            description: Chiave esterna per la dimensione product.
            tests:
              - relationships:
                  to: source('raw_data', 'products_raw')
                  field: product_key

          - name: reseller_key
            description: Chiave esterna per la dimensione reseller.
            tests:
              - relationships:
                  to: source('raw_data', 'reseller_raw')
                  field: reseller_key
          
          - name: sales_territory_key
            description: Chiave esterna per la dimensione sales territory.
            tests:
              - relationships:
                  to: source('raw_data', 'sales_territory_raw')
                  field: sales_territory_key
          
          - name: order_date_key
            description: Chiave esterna per la data di creazione dell'ordine.
            tests:
              - relationships:
                  to: source('raw_data', 'dates_raw')
                  field: date_key

          - name: ship_date_key
            description: Chiave esterna per la data di spedizione.
            tests:
              - relationships:
                  to: source('raw_data', 'dates_raw')
                  field: date_key
          
          - name: due_date_key
            description: Chiave esterna per la data di consegna effettiva.
            tests:
              - relationships:
                  to: source('raw_data', 'dates_raw')
                  field: date_key


      - name: order_details_raw
        description: dati di dettaglio ordine e canale.
        columns:
          - name: sales_order_line_key
            description: chiave primaria della riga d'ordine (usata per joining con sales_data).
            tests:
              - unique
              - not_null
              - relationships:
                  to: source('raw_data', 'orders_raw')
                  field: sales_order_line_key